<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Parent Frame (Receiver)</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #f4f4f4; }
        .log-box { background: #fff; border: 1px solid #999; padding: 10px; margin-bottom: 20px; min-height: 100px; }
        .msg { margin: 5px 0; border-bottom: 1px solid #eee; padding-bottom: 2px; }
        .intercept { color: #d9534f; font-weight: bold; } /* Red for intercepts */
        .success { color: #5cb85c; font-weight: bold; } /* Green for success */
        .info { color: #0275d8; }
    </style>
</head>
<body>

    <h2>Parent Window</h2>
    <p>Origin: <script>document.write(window.origin)</script></p>
    
    <div class="log-box" id="parentLog"><strong>Parent Log:</strong><br></div>

    <iframe id="childFrame" 
            src="https://kevin-braunstein.github.io/postmessagecrossoriginchild/" 
            width="600" height="400"
            style="border: 2px solid #333;">
    </iframe>

    <script>
        const logger = document.getElementById('parentLog');
        function log(text, type = "") {
            const div = document.createElement('div');
            div.className = "msg " + type;
            div.innerHTML = `[Parent] ${text}`;
            logger.appendChild(div);
        }

        // --- 1. OVERRIDE postMessage on PARENT ---
        try {
            window.__defineGetter__("postMessage", function() {
                return function(msg, origin) {
                    log("INTERCEPTED: A script tried to call postMessage on the Parent window directly!", "intercept");
                }
            });
            log("Locally overrode window
